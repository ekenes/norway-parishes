{"version":3,"file":"EffectView-Bo5aSjzK.js","sources":["../../node_modules/@arcgis/core/layers/effects/EffectView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Accessor.js\";import has from\"../../core/has.js\";import{clone as s}from\"../../core/lang.js\";import r from\"../../core/Logger.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import{parse as c}from\"./parser.js\";import{canInterpolateEffects as o,normalizeEffects as f}from\"./utils.js\";const l=-1;let a=class extends e{constructor(t){super(t),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=has(\"mapview-transitions-duration\"),this.effects=[]}set effect(t){if(this._get(\"effect\")!==(t=t||\"\")){this._set(\"effect\",t);try{this._transitionTo(h(t))}catch(e){this._transitionTo([]),r.getLogger(this).warn(\"Invalid Effect\",{effect:t,error:e})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(t){this._updateForScale(t)}get transitioning(){return null!==this._to}canTransitionTo(t){try{return this.scale>0&&u(this._current,h(t),this.scale)}catch{return!1}}transitionStep(t,e){this._applyTimeTransition(t),this._updateForScale(e)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(t){this.scale>0&&u(this._current,t,this.scale)?(this._final=t,this._to=s(t),_(this._current,this._to,this.scale),this._from=s(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t),this._set(\"effects\",this._current[0]?s(this._current[0].effects):[])}_applyTimeTransition(t){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=t;const e=Math.min(1,this._time/this.duration);for(let s=0;s<this._current.length;s++){const t=this._current[s],r=this._from[s],i=this._to[s];t.scale=p(r.scale,i.scale,e);for(let s=0;s<t.effects.length;s++){const n=t.effects[s],c=r.effects[s],o=i.effects[s];n.interpolate(c,o,e)}}1===e&&(this._current=this._final,this._set(\"effects\",this._current[0]?s(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(t){if(this._set(\"scale\",t),0===this._current.length)return;const e=this._current,s=this._current.length-1;let r,i,n=1;if(1===e.length||t>=e[0].scale)i=r=e[0].effects;else if(t<=e[s].scale)i=r=e[s].effects;else for(let c=0;c<s;c++){const s=e[c],o=e[c+1];if(s.scale>=t&&o.scale<=t){n=(t-s.scale)/(o.scale-s.scale),r=s.effects,i=o.effects;break}}for(let c=0;c<this.effects.length;c++){this.effects[c].interpolate(r[c],i[c],n)}}};function h(t){const e=c(t)||[];return m(e)?[{scale:l,effects:e}]:e}function u(t,e,s){if(!t[0]?.effects||!e[0]?.effects)return!0;return!((t[0]?.scale===l||e[0]?.scale===l)&&(t.length>1||e.length>1)&&s<=0)&&o(t[0].effects,e[0].effects)}function _(t,e,s){const r=t.length>e.length?t:e,i=t.length>e.length?e:t,n=i[i.length-1],c=n?.scale??s,o=n?.effects??[];for(let f=i.length;f<r.length;f++)i.push({scale:c,effects:[...o]});for(let a=0;a<r.length;a++)i[a].scale=i[a].scale===l?s:i[a].scale,r[a].scale=r[a].scale===l?s:r[a].scale,f(i[a].effects,r[a].effects)}function p(t,e,s){return t+(e-t)*s}function m(t){const e=t[0];return!!e&&\"type\"in e}t([i()],a.prototype,\"_to\",void 0),t([i()],a.prototype,\"duration\",void 0),t([i({value:\"\"})],a.prototype,\"effect\",null),t([i({readOnly:!0})],a.prototype,\"effects\",void 0),t([i({readOnly:!0})],a.prototype,\"final\",null),t([i({readOnly:!0})],a.prototype,\"hasEffects\",null),t([i({value:0})],a.prototype,\"scale\",null),t([i({readOnly:!0})],a.prototype,\"transitioning\",null),a=t([n(\"esri.layers.effects.EffectView\")],a);export{a as EffectView,u as canInterpolateEffectStops,h as convertEffectToStops,_ as normalizeEffectStops};\n"],"names":["l","a","e","has","h","r","u","s","_","t","i","p","n","c","o","m","_b","_d","f"],"mappings":"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","x_google_ignoreList":[0]}
{"version":3,"file":"label-043ae25a-fVHJCEKA.js","sources":["../../node_modules/@esri/calcite-components/dist/esm/label-043ae25a.js"],"sourcesContent":["/*!\n * All material copyright ESRI, All Rights Reserved, unless otherwise specified.\n * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.\n * v2.13.2\n */\nimport { j as isBefore, q as queryElementRoots, a as closestElementCrossShadowBoundary } from './dom-b6dedd88.js';\nimport { c as componentOnReady } from './component-5f0a8be8.js';\n\n/**\n * Exported for testing purposes only\n *\n * @internal\n */\nconst labelClickEvent = \"calciteInternalLabelClick\";\nconst labelConnectedEvent = \"calciteInternalLabelConnected\";\nconst labelDisconnectedEvent = \"calciteInternalLabelDisconnected\";\nconst labelTagName = \"calcite-label\";\nconst labelToLabelables = new WeakMap();\nconst onLabelClickMap = new WeakMap();\nconst onLabelConnectedMap = new WeakMap();\nconst onLabelDisconnectedMap = new WeakMap();\nconst unlabeledComponents = new Set();\nconst findLabelForComponent = (componentEl) => {\n    const { id } = componentEl;\n    const forLabel = id && queryElementRoots(componentEl, { selector: `${labelTagName}[for=\"${id}\"]` });\n    if (forLabel) {\n        return forLabel;\n    }\n    const parentLabel = closestElementCrossShadowBoundary(componentEl, labelTagName);\n    if (!parentLabel ||\n        // labelable components within other custom elements are not considered labelable\n        hasAncestorCustomElements(parentLabel, componentEl)) {\n        return null;\n    }\n    return parentLabel;\n};\nfunction hasAncestorCustomElements(label, componentEl) {\n    let traversedElements;\n    const customElementAncestorCheckEventType = \"custom-element-ancestor-check\";\n    const listener = (event) => {\n        event.stopImmediatePropagation();\n        const composedPath = event.composedPath();\n        traversedElements = composedPath.slice(composedPath.indexOf(componentEl), composedPath.indexOf(label));\n    };\n    label.addEventListener(customElementAncestorCheckEventType, listener, { once: true });\n    componentEl.dispatchEvent(new CustomEvent(customElementAncestorCheckEventType, { composed: true, bubbles: true }));\n    label.removeEventListener(customElementAncestorCheckEventType, listener);\n    const ancestorCustomElements = traversedElements\n        .filter((el) => el !== componentEl && el !== label)\n        .filter((el) => el.tagName?.includes(\"-\"));\n    return ancestorCustomElements.length > 0;\n}\n/**\n * Helper to set up label interactions on connectedCallback.\n *\n * @param component\n */\nfunction connectLabel(component) {\n    if (!component) {\n        return;\n    }\n    const labelEl = findLabelForComponent(component.el);\n    if ((onLabelClickMap.has(labelEl) && labelEl === component.labelEl) ||\n        (!labelEl && unlabeledComponents.has(component))) {\n        return;\n    }\n    const boundOnLabelDisconnected = onLabelDisconnected.bind(component);\n    if (labelEl) {\n        component.labelEl = labelEl;\n        const labelables = labelToLabelables.get(labelEl) || [];\n        labelables.push(component);\n        labelToLabelables.set(labelEl, labelables.sort(sortByDOMOrder));\n        if (!onLabelClickMap.has(component.labelEl)) {\n            onLabelClickMap.set(component.labelEl, onLabelClick);\n            component.labelEl.addEventListener(labelClickEvent, onLabelClick);\n        }\n        unlabeledComponents.delete(component);\n        document.removeEventListener(labelConnectedEvent, onLabelConnectedMap.get(component));\n        onLabelDisconnectedMap.set(component, boundOnLabelDisconnected);\n        document.addEventListener(labelDisconnectedEvent, boundOnLabelDisconnected);\n    }\n    else if (!unlabeledComponents.has(component)) {\n        boundOnLabelDisconnected();\n        document.removeEventListener(labelDisconnectedEvent, onLabelDisconnectedMap.get(component));\n    }\n}\n/**\n * Helper to tear down label interactions on disconnectedCallback on labelable components.\n *\n * @param component\n */\nfunction disconnectLabel(component) {\n    if (!component) {\n        return;\n    }\n    unlabeledComponents.delete(component);\n    document.removeEventListener(labelConnectedEvent, onLabelConnectedMap.get(component));\n    document.removeEventListener(labelDisconnectedEvent, onLabelDisconnectedMap.get(component));\n    onLabelConnectedMap.delete(component);\n    onLabelDisconnectedMap.delete(component);\n    if (!component.labelEl) {\n        return;\n    }\n    const labelables = labelToLabelables.get(component.labelEl);\n    if (labelables.length === 1) {\n        component.labelEl.removeEventListener(labelClickEvent, onLabelClickMap.get(component.labelEl));\n        onLabelClickMap.delete(component.labelEl);\n    }\n    labelToLabelables.set(component.labelEl, labelables.filter((labelable) => labelable !== component).sort(sortByDOMOrder));\n    component.labelEl = null;\n}\nfunction sortByDOMOrder(a, b) {\n    return isBefore(a.el, b.el) ? -1 : 1;\n}\n/**\n * Helper to get the label text from a component.\n *\n * @param component\n */\nfunction getLabelText(component) {\n    return component.label || component.labelEl?.textContent?.trim() || \"\";\n}\nfunction onLabelClick(event) {\n    const labelClickTarget = event.detail.sourceEvent.target;\n    const labelables = labelToLabelables.get(this);\n    const clickedLabelable = labelables.find((labelable) => labelable.el === labelClickTarget);\n    const labelableChildClicked = labelables.includes(clickedLabelable);\n    if (labelableChildClicked) {\n        // no need to forward click as labelable will receive focus\n        return;\n    }\n    const firstLabelable = labelables[0];\n    if (firstLabelable.disabled) {\n        return;\n    }\n    firstLabelable.onLabelClick(event);\n}\nfunction onLabelConnected() {\n    if (unlabeledComponents.has(this)) {\n        connectLabel(this);\n    }\n}\nfunction onLabelDisconnected() {\n    unlabeledComponents.add(this);\n    const boundOnLabelConnected = onLabelConnectedMap.get(this) || onLabelConnected.bind(this);\n    onLabelConnectedMap.set(this, boundOnLabelConnected);\n    document.addEventListener(labelConnectedEvent, boundOnLabelConnected);\n}\n/**\n * Helper to associate an explicit label (i.e., using `for`) with a labelable component that does not have an associated label.\n *\n * @param label - the label element\n */\nasync function associateExplicitLabelToUnlabeledComponent(label) {\n    await componentOnReady(label);\n    const alreadyLabeled = labelToLabelables.has(label);\n    if (alreadyLabeled) {\n        return;\n    }\n    const forComponentEl = label.ownerDocument?.getElementById(label.for);\n    if (!forComponentEl) {\n        return;\n    }\n    requestAnimationFrame(() => {\n        for (const labelable of unlabeledComponents) {\n            if (labelable.el === forComponentEl) {\n                connectLabel(labelable);\n                break;\n            }\n        }\n    });\n}\n\nexport { associateExplicitLabelToUnlabeledComponent as a, labelDisconnectedEvent as b, connectLabel as c, disconnectLabel as d, getLabelText as g, labelConnectedEvent as l };\n\n//# sourceMappingURL=label-043ae25a.js.map"],"names":["labelClickEvent","labelConnectedEvent","labelDisconnectedEvent","labelTagName","labelToLabelables","onLabelClickMap","onLabelConnectedMap","onLabelDisconnectedMap","unlabeledComponents","findLabelForComponent","componentEl","id","forLabel","queryElementRoots","parentLabel","closestElementCrossShadowBoundary","hasAncestorCustomElements","label","traversedElements","customElementAncestorCheckEventType","listener","event","composedPath","el","_a","connectLabel","component","labelEl","boundOnLabelDisconnected","onLabelDisconnected","labelables","sortByDOMOrder","onLabelClick","disconnectLabel","labelable","a","b","isBefore","getLabelText","_b","labelClickTarget","clickedLabelable","firstLabelable","onLabelConnected","boundOnLabelConnected","associateExplicitLabelToUnlabeledComponent","componentOnReady","forComponentEl"],"mappings":"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","x_google_ignoreList":[0]}
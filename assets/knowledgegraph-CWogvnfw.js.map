{"version":3,"mappings":"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","names":["F","J","r","t","e","v","G","R","U","n","o","A","a","I","M","b","__vitePreload","Q","s","u","m","d","g","h","i","S","c","w","k","E","x","K","V","W","D","q","N","y","C","p","l","P","j","f","T","_a"],"ignoreList":[0],"sources":["../../node_modules/@arcgis/core/arcade/functions/knowledgegraph.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../config.js\";import\"../../geometry.js\";import r from\"../ArcadePortal.js\";import t from\"../Dictionary.js\";import{ArcadeExecutionError as n,ExecutionErrorCodes as o}from\"../executionError.js\";import{G as a,j as i,c as s,w as p,K as l,o as c,N as f,b as u,k as m,m as d,n as g,v as h,p as w,a6 as y}from\"../../chunks/languageUtils.js\";import{getPortal as j}from\"../portalUtils.js\";import S from\"../../geometry/Geometry.js\";import{isLoaded as v,load as G,project as R}from\"../../geometry/projection.js\";import{webMercatorToGeographic as k,geographicToWebMercator as x}from\"../../geometry/support/webMercatorUtils.js\";import P from\"../../portal/Portal.js\";import b from\"../../portal/PortalItem.js\";import{project as I}from\"../../rest/geometryService/project.js\";import W from\"../../rest/knowledgeGraph/Entity.js\";import T from\"../../rest/knowledgeGraph/GraphQueryStreaming.js\";import D from\"../../rest/knowledgeGraph/ObjectValue.js\";import N from\"../../rest/knowledgeGraph/Path.js\";import q from\"../../rest/knowledgeGraph/Relationship.js\";import A from\"../../rest/support/ProjectParameters.js\";import U from\"../../geometry/SpatialReference.js\";let F=null;async function J(r){const t=e.geometryServiceUrl??\"\";if(!t){v()||await G();for(const e of r)e.container[e.indexer]=R(e.container[e.indexer],U.WGS84);return}const n=r.map((e=>e.container[e.indexer])),o=new A({geometries:n,outSpatialReference:U.WGS84}),a=await I(t,o);for(let e=0;e<a.length;e++){const t=r[e];t.container[t.indexer]=a[e]}}async function M(e,r){const t=new b({portal:e,id:r});return await t.load(),null===F&&(F=await import(\"../../rest/knowledgeGraphService.js\")),await F.fetchKnowledgeGraph(t.url)}function Q(e,r,t,n,o){if(null===e)return null;if(s(e)||u(e))return e;if(m(e))return e.toJSDate();if(m(e))return e.toJSDate();if(d(e))return e.toStorageFormat();if(g(e))return e.toStorageString();if(h(e)){const a={};for(const i of e.keys())a[i]=Q(e.field(i),r,t,n,o),a[i]instanceof S&&o.push({container:a,indexer:i});return a}if(c(e)){const a=e.map((e=>Q(e,r,t,n,o)));for(let e=0;e<a.length;e++)a[e]instanceof S&&o.push({container:a,indexer:e});return a}return w(e)?e.spatialReference.isWGS84?e:e.spatialReference.isWebMercator&&r?k(e):e:void 0}function E(e,r){if(!e)return e;if(e.spatialReference.isWGS84&&r.spatialReference.isWebMercator)return x(e);if(e.spatialReference.equals(r.spatialReference))return e;throw new n(r,o.WrongSpatialReference,null)}function K(e,r){if(!e)return null;const t={};for(const n in e)t[n]=V(e[n],r);return t}function V(e,r){return null===e?null:c(e)?e.map((e=>V(e,r))):e instanceof W?{graphTypeName:e.typeName,id:e.id,graphType:\"entity\",properties:K(e.properties,r)}:e instanceof D?{graphType:\"object\",properties:K(e.properties,r)}:e instanceof q?{graphTypeName:e.typeName,id:e.id,graphType:\"relationship\",originId:e.originId??null,destinationId:e.destinationId??null,properties:K(e.properties,r)}:e instanceof N?{graphType:\"path\",path:e.path?e.path.map((e=>V(e,r))):null}:w(e)?E(e,r):s(e)||u(e)||y(e)?e:null}function C(e){\"async\"===e.mode&&(e.functions.knowledgegraphbyportalitem=function(t,p){return e.standardFunctionAsync(t,p,((e,l,c)=>{if(a(c,2,2,t,p),null===c[0])throw new n(t,o.PortalRequired,p);if(c[0]instanceof r){const e=i(c[1]);let r;r=t.services?.portal?t.services.portal:P.getDefault();return M(j(c[0],r),e)}if(!1===s(c[0]))throw new n(t,o.InvalidParameter,p);const f=i(c[0]);return M(t.services?.portal??P.getDefault(),f)}))},e.signatures.push({name:\"knowledgegraphbyportalitem\",min:2,max:2}),e.functions.querygraph=function(r,i){return e.standardFunctionAsync(r,i,(async(e,u,m)=>{a(m,2,4,r,i);const d=m[0];if(!p(d))throw new n(r,o.InvalidParameter,i);const g=m[1];if(!s(g))throw new n(r,o.InvalidParameter,i);null===F&&(F=await import(\"../../rest/knowledgeGraphService.js\"));let h=null;const w=l(m[2],null);if(!(w instanceof t||null===w))throw new n(r,o.InvalidParameter,i);if(w){let e=[];h=Q(w,!0,!1,r,e),e=e.filter((e=>!e.container[e.indexer].spatialReference.isWGS84)),e.length>0&&await J(e)}const y=new T({openCypherQuery:g,bindParameters:h});(d?.serviceDefinition?.currentVersion??11.3)>11.2&&(y.outputSpatialReference=r.spatialReference);const j=(await F.executeQueryStreaming(d,y)).resultRowsStream.getReader(),S=[];try{for(;;){const{done:e,value:t}=await j.read();if(e)break;if(c(t))for(const n of t)S.push(V(n,r));else{const e=[];for(const n of t)e.push(V(t[n],r));S.push(e)}}}catch(v){throw v}return t.convertJsonToArcade(S,f(r),!1,!0)}))},e.signatures.push({name:\"querygraph\",min:2,max:4}))}export{C as registerFunctions};\n"],"file":"assets/knowledgegraph-CWogvnfw.js"}
const L=9999999e31,S=2e-7,V={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function k(t){return V[t]??[-34028234663852886e22,34028234663852886e22]}function P(t,s){return t==null||s==null?"s32":t<0?t>=-128&&s<128?"s8":t>=-32768&&s<32768?"s16":"s32":s<256?"u8":s<65536?"u16":"u32"}function v(t){return((t==null?void 0:t.startsWith("s"))||(t==null?void 0:t.startsWith("u")))??!1}function U(t,s,n,l){let[u,o]=k(n);const e=v(n);return e&&(u-=1e-5,o+=1e-5),e?n.startsWith("u")?y(t,s,l,[u,o]):I(t,s,l,[u,o]):O(t,s,l,[u,o])}function W(t,s){for(let n=0;n<s.length;n++)s[n]&&isNaN(t[n])&&(s[n]=0,t[n]=0)}function y(t,s,n,l){const[u,o]=l;for(let e=0;e<s.length;e++)if(s[e]){const i=t[e];i<u||i>o?s[e]=0:n[e]=i+.5|0}}function I(t,s,n,l){const[u,o]=l;for(let e=0;e<s.length;e++)if(s[e]){const i=t[e];i<u||i>o?s[e]=0:n[e]=i+(i>0?.5:-.5)|0}}function O(t,s,n,l){const[u,o]=l;for(let e=0;e<s.length;e++)if(s[e]){const i=t[e];i<u||i>o?s[e]=0:n[e]=i}}function w(t,s,n){var N,g;if(t.depthCount&&t.depthCount>1)return;const{pixels:l,statistics:u,pixelType:o}=t,e=l[0].length,i=t.bandMasks??[],m=t.mask??new Uint8Array(e).fill(255),x=o==="f32"||o==="f64",p=k(o);let d=!1;for(let a=0;a<l.length;a++){const r=typeof s=="number"?s:s[a];if(r==null)continue;const A=((N=u==null?void 0:u[a])==null?void 0:N.minValue)??p[0],E=((g=u==null?void 0:u[a])==null?void 0:g.maxValue)??p[1];if(A>r+Number.EPSILON||E<r-Number.EPSILON)continue;const b=i[a]||m.slice(),h=l[a],M=n==null?void 0:n.customFloatTolerance;if(x&&M!==0){let f=M;f||(f=Math.abs(r)>=L?S*Math.abs(r):o==="f32"?2**-23:Number.EPSILON);for(let c=0;c<h.length;c++)b[c]&&Math.abs(h[c]-r)<f&&(h[c]=0,b[c]=0,m[c]=0,d=!0)}else for(let f=0;f<h.length;f++)b[f]&&h[f]===r&&(h[f]=0,b[f]=0,m[f]=0,d=!0);i[a]=b}d&&(t.bandMasks=t.bandMasks||t.pixels.length>1?i:null,t.mask=m),d&&"updateStatistics"in t&&t.updateStatistics()}export{w as a,U as i,W as l,v as o,k as s,P as u};
//# sourceMappingURL=pixelRangeUtils-Ba7Ehdiw.js.map

{"version":3,"file":"RasterWorker-CakIDK4s.js","sources":["../../node_modules/@arcgis/core/layers/support/rasterTransforms/IdentityTransform.js","../../node_modules/@arcgis/core/layers/support/rasterTransforms/utils.js","../../node_modules/@arcgis/core/layers/support/RasterWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{enumeration as o}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import t from\"./BaseRasterTransform.js\";var e;let a=e=class extends t{constructor(){super(...arguments),this.type=\"identity\"}clone(){return new e}};r([o({IdentityXform:\"identity\"})],a.prototype,\"type\",void 0),a=e=r([s(\"esri.layers.support.rasterTransforms.IdentityTransform\")],a);const p=a;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"./GCSShiftTransform.js\";import t from\"./IdentityTransform.js\";import n from\"./PolynomialTransform.js\";const o={GCSShiftXform:r,IdentityXform:t,PolynomialXform:n},e=Object.keys(o);function f(r){const t=r?.type;return!r||e.includes(t)}function i(r){const t=r?.type;if(!t)return null;const n=o[r?.type];if(n){const t=new n;return t.read(r),t}return null}export{f as isTransformSupported,i as readTransform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import r from\"../../geometry/support/GeographicTransformation.js\";import e from\"./PixelBlock.js\";import{decode as t}from\"./rasterFormats/RasterCodec.js\";import{split as s,clipTile as o,mosaic as i,approximateTransform as n,getLocalArithmeticNorthRotations as a}from\"./rasterFunctions/pixelUtils.js\";import{create as l}from\"./rasterFunctions/rasterFunctionHelper.js\";import{requirePE as m,load as c,getProjectionOffsetGrid as f}from\"./rasterFunctions/rasterProjectionHelper.js\";import{computeStatisticsHistograms as p,estimateStatisticsHistograms as u}from\"./rasterFunctions/stretchUtils.js\";import{convertVectorFieldData as S,convertToLocalDirections as d}from\"./rasterFunctions/vectorFieldUtils.js\";import{readTransform as x}from\"./rasterTransforms/utils.js\";import y from\"../../renderers/support/RasterSymbolizer.js\";import{createFlowMesh as O}from\"../../views/2d/engine/flow/dataUtils.js\";import h from\"../../geometry/Extent.js\";import N from\"../../geometry/Point.js\";class J{convertVectorFieldData(r){const t=e.fromJSON(r.pixelBlock),s=S(t,r.type);return Promise.resolve(null!=s?s.toJSON():null)}computeStatisticsHistograms(r){const t=e.fromJSON(r.pixelBlock),s=p(t);return Promise.resolve(s)}async decode(r){const e=await t(r.data,r.options);return e&&e.toJSON()}symbolize(r){r.pixelBlock=e.fromJSON(r.pixelBlock),r.extent=r.extent?h.fromJSON(r.extent):null;const t=this.symbolizer.symbolize(r);return Promise.resolve(null!=t?t.toJSON():null)}async updateSymbolizer(r){this.symbolizer=y.fromJSON(r.symbolizerJSON),r.histograms&&\"rasterStretch\"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=r.histograms)}async updateRasterFunction(r){this.rasterFunction=l(r.rasterFunctionJSON)}async process(r){const t=this.rasterFunction.process({extent:h.fromJSON(r.extent),primaryPixelBlocks:r.primaryPixelBlocks.map((r=>null!=r?e.fromJSON(r):null)),primaryPixelSizes:r.primaryPixelSizes?.map((r=>null!=r?N.fromJSON(r):null)),primaryRasterIds:r.primaryRasterIds});return null!=t?t.toJSON():null}stretch(r){const t=this.symbolizer.simpleStretch(e.fromJSON(r.srcPixelBlock),r.stretchParams);return Promise.resolve(t?.toJSON())}estimateStatisticsHistograms(r){const t=u(e.fromJSON(r.srcPixelBlock));return Promise.resolve(t)}split(r){const t=s(e.fromJSON(r.srcPixelBlock),r.tileSize,r.maximumPyramidLevel??0,!1===r.useBilinear);return t&&t.forEach(((r,e)=>{t.set(e,r?.toJSON())})),Promise.resolve(t)}clipTile(r){const t=e.fromJSON(r.pixelBlock),s=o({...r,pixelBlock:t});return Promise.resolve(s?.toJSON())}async mosaicAndTransform(r){const t=r.srcPixelBlocks.map((r=>r?new e(r):null)),s=i(t,r.srcMosaicSize,{blockWidths:r.blockWidths,alignmentInfo:r.alignmentInfo,clipOffset:r.clipOffset,clipSize:r.clipSize});let o,l=s;return r.coefs&&(l=n(s,r.destDimension,r.coefs,r.sampleSpacing,r.interpolation)),r.projectDirections&&r.gcsGrid&&(o=a(r.destDimension,r.gcsGrid),l=d(l,r.isUV?\"vector-uv\":\"vector-magdir\",o)),{pixelBlock:l?.toJSON(),localNorthDirections:o}}async createFlowMesh(r,e){const t={data:new Float32Array(r.flowData.buffer),mask:new Uint8Array(r.flowData.maskBuffer),width:r.flowData.width,height:r.flowData.height},{vertexData:s,indexData:o}=await O(r.meshType,r.simulationSettings,t,e.signal);return{result:{vertexBuffer:s.buffer,indexBuffer:o.buffer},transferList:[s.buffer,o.buffer]}}async getProjectionOffsetGrid(e){const t=h.fromJSON(e.projectedExtent),s=h.fromJSON(e.srcBufferExtent);let o=null;e.datumTransformationSteps&&(o=new r({steps:e.datumTransformationSteps})),(e.includeGCSGrid||m(t.spatialReference,s.spatialReference,o))&&await c();const i=e.rasterTransform?x(e.rasterTransform):null;return f({...e,projectedExtent:t,srcBufferExtent:s,datumTransformation:o,rasterTransform:i})}}export{J as default};\n"],"names":["e","a","t","r","o","s","p","n","i","J","S","h","y","_a","l","N","u","d","O","m","c","x","f"],"mappings":"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","x_google_ignoreList":[0,1,2]}